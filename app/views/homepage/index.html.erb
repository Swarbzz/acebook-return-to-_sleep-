<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Homepage</title>
</head>
<body>
  <html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>aceBook</title>
</head>
<body>

<div class="container">
  <% if @user != nil %>
    <div class="jumbotron jumbotron-fluid">
      <div class="container">
        <h1 class="display-4">Hello <a href="/users/<%=@user.id%>/timeline"><%= @user.name %></a></h1>
        <p class="lead">Welcome to aceBook</p>
      </div>
    </div>
  <%end%>
  <div class="row">
  <!--Posts-->
    <div class="col-10">
      <% if @user != nil %>
         <% @posts.reverse.each do |post| %>
        <div class="card text-center">
          <div class="card-header">
            <%= User.find(post.poster_id).name %>
          </div>
      <div class="card-body">
        <p class="card-text">
        <%= post.content %>
        </p>
        <p><%= post.likes.count %> <%= (post.likes.count) == 1 ? 'Like' : 'Likes'%> / <%= post.dislikes.count %> <%= (post.dislikes.count) == 1 ? 'Dislike' : 'Dislikes'%></p>â€©
    <!--Like/Dislike-->
        <div class="btn-group">
          <% pre_like = post.likes.find { |like| like.user_id == session[:current_user] }%>
            <% if pre_like %>
        <%= button_to 'Unlike', post_like_path(post, pre_like), class: 'btn btn-success btn-sm', method: :delete %>
      <% else %> 
        <%= button_to 'Like',post_likes_path(post), class: 'btn btn-success btn-sm', method: :post  %>
      <% end %>
      &nbsp;
      <% pre_dislike = post.dislikes.find{|dislike| dislike.user_id == session[:current_user]}%>
      <%if pre_dislike%>
        <%= button_to 'Undislike', post_dislike_path(post, pre_dislike), method: :delete, class: 'btn btn-danger btn-sm'%>
      <%else%>
        <%= button_to 'Dislike', post_dislikes_path(post), method: :post, class: 'btn btn-danger btn-sm'%>
      <%end%>
    </div>
    </p>
  
  <button class="btn btn-warning" type="button" data-toggle="collapse" data-target="#collapseComment" aria-expanded="false" aria-controls="collapseComment">
    Comment
  </button>
  </p>
  <div class="collapse" id="collapseComment">
    <form action="/home/<%= post.id %>/comments" method="post" class="form-group">
          <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
            <textarea name="comment" id=""  rows="3" class="form-control"></textarea>
          <input type="submit" name="Comment" value="Submit Comment" class="btn btn-success">
        </form>
    </div>
    
    <div>
      <form action="/posts/<%= post.id %>/edit" method="get" class="form-group">
          <input type="submit" value="Edit this post" class="btn btn-primary">
        </form>
      </div>
      <div>
        <form action="/posts/<%= post.id %>" method="POST" class="form-group">
          <input type="hidden" name="authenticity_token" id="<%= form_authenticity_token %>">
          <input type="hidden" name="_method" id="DELETE">
          <input type="submit" value="Delete this post" class="btn btn-dark">
        </form>
        </div>
  </div>
  <div class="card-footer text-muted">
    <%= post.time %>
  </div>
</div>
              <% end %>
        
      <% else %>
      <h3>Log in to view posts</h3>
          <form action="/sign-up" method="get" class="form-group">
              <input type="submit" name="sign_up" value="Sign Up" class="form-control">
          </form>
          
          <form action="/" method="get" class="form-group">
              <input type="submit" name="log_in" value="Log In" class="btn btn-primary">
          </form>
    <% end %>
    </div>
    <!--Current users-->
    <div class="col-2">
      <div class="signed_up_users_card">
          <h5>Current Users:</h5> 
          <div class="list-group">
            <% @users.each do |user| %>
                <a href="#" class="list-group-item list-group-item-action"><%= user.name %></a>
            <% end %>
          </div>
      </div>
    </div>
  </div>
</div>

   
  
  
</body>
</html>
</body>
</html>